export const ArrayProxy=function(e){return new Proxy(e,{set(e,t,n,r){if(t in e)Reflect.set(e,t,n,r);else for(let r of e)r[t]=n;return!0},get(e,t,n){if(t in e){let n=e[t];return"function"==typeof n?n.bind(e):n}{let n=[],r=e[0];if(r&&"function"==typeof r[t])return(...n)=>{for(let r=0;r<e.length;r++){let o=e[r],l=o[t].bind(o);if("function"==typeof n[0]){let e=n[0](r,...n.slice(1),o);e instanceof Array?l(...e):l(e)}else o[t](...n)}};for(let r of e){let o=r[t];n.push("function"==typeof o?o.bind(e):o)}return ArrayProxy(n)}}})};export const ErgoElement=function(e,{prefix:t="$",emitInputOnValueChange:n=!0}={}){return"string"==typeof e&&(e=document.querySelector(e)),new Proxy((function(t,n){if(n){let n=e.querySelectorAll(t);return ArrayProxy(n)}{let n=e.querySelector(t);return n?ErgoElement(n):null}}),{get(n,r,o){let l=e[r];return"self"===r?e:"function"==typeof l?l.bind(e):r in e?e[r]:(console.log(r),r&&r.startsWith&&r.startsWith(t)?n(r=r.slice(t.length),!0):n(r))},set:(t,r,o)=>(e[r]=o,"value"===r&&n&&e.dispatchEvent(new CustomEvent("input",{detail:o})),!0),apply:(e,t,n)=>e.apply(t,n)})};